FROM node:18-alpine

ARG DEV_FRONT_URL
ARG PROD_FRONT_URL
ARG GMAIL_USER
ARG MAIL_APP_PASSWORD
ARG JWT_SIGNATURE
ARG DEV_MYSQL_PASSWORD
ARG DEV_MYSQL_DATABASE
ARG PROD_MYSQL_USERNAME
ARG PROD_MYSQL_PASSWORD
ARG PROD_MYSQL_DATABASE
ARG PROD_MYSQL_HOST
ARG BACK_END_NODE_ENV

ENV DEV_FRONT_URL=$DEV_FRONT_URL
ENV PROD_FRONT_URL=$PROD_FRONT_URL
ENV GMAIL_USER=$GMAIL_USER
ENV MAIL_APP_PASSWORD=$MAIL_APP_PASSWORD
ENV JWT_SIGNATURE=$JWT_SIGNATURE
ENV DEV_MYSQL_PASSWORD=$DEV_MYSQL_PASSWORD
ENV DEV_MYSQL_DATABASE=$DEV_MYSQL_DATABASE
ENV PROD_MYSQL_USERNAME=$PROD_MYSQL_USERNAME
ENV PROD_MYSQL_PASSWORD=$PROD_MYSQL_PASSWORD
ENV PROD_MYSQL_DATABASE=$PROD_MYSQL_DATABASE
ENV PROD_MYSQL_HOST=$PROD_MYSQL_HOST
ENV BACK_END_NODE_ENV=$BACK_END_NODE_ENV

WORKDIR /app

COPY package.json .

RUN npm install 

COPY . .

EXPOSE 80

CMD [ "npm", "start" ]
